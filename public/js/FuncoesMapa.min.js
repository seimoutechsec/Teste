var geral;var map;var ID=new Array();var GMarcador=new Array();var currentPosition;var geocoder;var lastMarker;var casa;function UneCordenadas(){geral=null;if(ID.length>0)x=ID.length+1;else x=10;for(i=0;i<x;i++){if(GMarcador[i]){aux1=new google.maps.LatLng(GMarcador[i].getPosition().lat(),GMarcador[i].getPosition().lng());novo=new google.maps.LatLngBounds(aux1);if(!geral)geral=novo;else geral.union(novo);}}}
function AjustaMapa(){UneCordenadas();if(geral)map.fitBounds(geral);else initialize();}
function initialize(){var opts={zoom:8,center:new google.maps.LatLng(-23.5,-46.6),mapTypeId:google.maps.MapTypeId.ROADMAP}
map=new google.maps.Map(document.getElementById("map"),opts);addGeoCoder();}
function initializeMain(){var opts={zoom:8,center:new google.maps.LatLng(-23.5,-46.6),mapTypeId:google.maps.MapTypeId.ROADMAP}
map=new google.maps.Map(document.getElementById("map"),opts);}
function ChangeIcons(id,icon){icone=new google.maps.MarkerImage(icon);i=SearchMarcador(id);if(i!=-1)
GMarcador[i].setIcon(icone);}
function addMarcador(id,lat,lng,icon){mark=new google.maps.LatLng(lat,lng);icone=new google.maps.MarkerImage(icon);if(ID.length>0)x=ID.length+1;else x=10;for(i=0;i<x;i++){if(!GMarcador[i]){ID[i]=id;GMarcador[i]=new google.maps.Marker({Map:map,position:mark,icon:icone});break;}}}
function addMarcadorMemoria(id,lat,lng,icon){mark=new google.maps.LatLng(lat,lng);icone=new google.maps.MarkerImage(icon);var image=new google.maps.MarkerImage(casa,new google.maps.Size(71,71),new google.maps.Point(0,0),new google.maps.Point(17,34),new google.maps.Size(35,35));var marker=new google.maps.Marker({map:map,position:mark});map.setCenter(marker.getPosition());map.setZoom(16);currentPosition=marker.getPosition();setMarkerLocation();google.maps.event.addListener(marker,'drag',function(){currentPosition=marker.getPosition();setMarkerLocation();});lastMarker=marker;}
function moveMarcador(id,lat,lng){i=SearchMarcador(id);if(i!=-1){mark=new google.maps.LatLng(lat,lng);GMarcador[i].setPosition(mark);AjustaMapa();}}
function ShowMarcador(){if(ID.length>0)x=ID.length+1;else x=10;for(i=0;i<x;i++)
if(GMarcador[i])
GMarcador[i].setMap(map);}
function RemoveMarcador(id){i=SearchMarcador(id);if(i!=-1){GMarcador[i].setMap(null);GMarcador[i]=null;ID[i]=null;}
AjustaMapa();}
function SearchMarcador(id){if(ID.length>0)x=ID.length+1;else x=10;for(i=0;i<x;i++){if(ID[i]==id)
break;}
if(i==10&&ID[i]!=id)
i=-1;return i;}
function addAutoComplete(){var input=document.getElementById('searchTextField');var autocomplete=new google.maps.places.Autocomplete(input);autocomplete.bindTo('bounds',map);}
function addSerchText(Text){var input=document.getElementById('searchTextField');input.value=Text;}
function setMarkerLocation(){var input=document.getElementById('location');input.value=currentPosition;}
function addGeoCoder(){geocoder=new google.maps.Geocoder();}
function codeAddress(address){if(lastMarker)
lastMarker.setMap(null);geocoder.geocode({'address':address,'partialmatch':true},function(results,status){if(status==google.maps.GeocoderStatus.OK){map.setCenter(results[0].geometry.location);map.setZoom(17);var marker=new google.maps.Marker({map:map,position:results[0].geometry.location,Draggable:true});lastMarker=marker;var image=new google.maps.MarkerImage(casa,new google.maps.Size(71,71),new google.maps.Point(0,0),new google.maps.Point(17,34),new google.maps.Size(35,35));marker.setIcon(image);currentPosition=marker.getPosition();setMarkerLocation();google.maps.event.addListener(marker,'drag',function(){currentPosition=marker.getPosition();setMarkerLocation();});}else{alert("Não foi possível efetuar a busca. Status: "+status);}});}